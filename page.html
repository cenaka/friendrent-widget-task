<!DOCTYPE html>
<html>
    <head>
        <title>Аренда недвижимости</title>
        <meta charset="utf-8">
        <link href="style.css" rel="stylesheet"/>
        <link href="css/popup.css" rel="stylesheet">
    </head>
    <body>
        <a href="#options" class="popup">изменить</a>
        <div id="ads">
            <div class="advertise">
                <a target="__blank" href="http://friendrent.ru/"> Квартира </a>
                <div class="price"> 20000 &#8381</div>
                <div class="description">ст.м. Академическая, пр-т Науки 17</div>
                <div class="time">20 июля 2015</div>
            </div>
            <button id="moreButton">Больше</button>
        </div>

        <div id="options">
            <div class="filterForm">
                <h1 class="title">Настройки</h1>

                <form action="" method="post" class="filterForm">
                    <select class="cities_list">
                        <option selected="selected">Выберите город</option>
                        <option>Москва</option>
                        <option>Санкт-Петербург</option>
                        <option>Нижний Новгород</option>
                        <option>Казань</option>
                        <option>Ростов-на-Дону</option>
                        <option>Волгоград</option>
                        <option>Краснодар</option>
                        <option>Саратов</option>
                        <option>Самара</option>
                        <option>Екатеринбург</option>
                        <option>Челябинск</option>
                        <option>Омск</option>
                        <option>Новосибирск</option>
                        <option>Красноярск</option>
                        <option>Пермь</option>
                        <option>Уфа</option>
                    </select>

                    <div class="priceNumber">
                        <input type="text" id="priceFrom" name="priceFrom" onfocus="checkTextInputHint(this);"
                               onblur="checkEmptyTextInput(this, 'Цена от');" value="Цена от" class="hintInput">
                        <input type="text" id="priceTo" name="priceTo" onfocus="checkTextInputHint(this);"
                               onblur="checkEmptyTextInput(this, 'до');" value="до" class="hintInput">
                    </div>
                    <div class="housingType">
                        <input type="checkbox" name="room" value="room" id='room'>
                        <label for="room">комната</label>
                        <input type="checkbox" name="flat" value="flat" id="flat">
                        <label for="flat">квартира</label>
                    </div>
                    <input type="button" id="reset" value="Сбросить">
                    <input type="button" id="submitBottom" value="Применить">
                </form>
            </div>
        </div>
    </body>
    <script src="js/jquery-2.1.4.js" type="application/javascript"></script>
    <script src="js/jquery.popup.min.js" type="application/javascript"></script>
    <script type="application/javascript">
        $("a.popup").popup(
//                {
//                    content: $("#options")
//                }
        );
        $(document).ready(function() {
            $('#moreButton').click(function() {
                $.getJSON( "ads.json", function(data) {
                    addSeveralAdvertises(data.advertises)
                });
            });
            $('#reset').click(function() {
                $('#room, #flat').val('').attr('checked', false);
                $('select option:first').attr('selected','1');
                makeTextInputHint(document.getElementById("priceFrom"), 'Цена от');
                makeTextInputHint(document.getElementById("priceTo"), 'до');


            })
        });



        function createDivElement(className, textContent) {
            var newDivElement = document.createElement('div');
            newDivElement.className = className;
            newDivElement.textContent = textContent;
            return newDivElement;
        }
        function createAElement(target, url, textContent) {
            var newAElement = document.createElement('a');
            newAElement.target = target;
            newAElement.href = url;
            newAElement.textContent = textContent;
            return newAElement;

        }
        function housingTypeConversion(serverType) {
            if (serverType === 'flat') {
                return ('Квартира');
            } else if (serverType === 'room') {
                return ('Комната');
            } else {
                return ('??????')
            }
        }

        function addAdvertise(advertise) {
            var list = document.getElementById("ads");
            var newHTMLAddvertise = document.createElement('div');
            newHTMLAddvertise.className = 'advertise';
            var type = createAElement('_blank', advertise.url, housingTypeConversion(advertise.type));
            var price = createDivElement('price', advertise.price + ' ₽');
            var desc = createDivElement('description', advertise.desc);
            var time = createDivElement('time', advertise.time);
            newHTMLAddvertise.appendChild(type);
            newHTMLAddvertise.appendChild(price);
            newHTMLAddvertise.appendChild(desc);
            newHTMLAddvertise.appendChild(time);
            list.insertBefore(newHTMLAddvertise, document.getElementById("moreButton"));
        }
        function addSeveralAdvertises(advertises) {
            for (var i = 0; i < advertises.length; i++) {
                addAdvertise(advertises[i]);
            }
        }


        function checkTextInputHint(element) {
            if (element.className == 'hintInput') {
                element.value='';
                element.className = '';
            }
        }

        function checkEmptyTextInput(element, hintText) {
            if (element.value === '' && element.className != 'hintInput') {
                element.value = hintText;
                element.className = 'hintInput';
            }
        }
        function makeTextInputHint(element, hintText) {
            element.value = hintText;
            element.className = 'hintInput';
        }

    </script>
</html>